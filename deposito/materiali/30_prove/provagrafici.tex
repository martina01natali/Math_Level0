%%%%%%%%%%%%%%%%%%%%%%%%%%
%        Prova grafici
% Compilazione: pdflatex --shell-escape provagrafici.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[10pt,a4paper,openright]{memoir}
%========================
% pgf & TikZ
%========================
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{tkz-fct}
\usetikzlibrary{arrows}

%--------------------------
% Nuovi comandi grafici:
%--------------------------

\newcommand{\disegno}[2][5]{% 
  % Esempio di chiamata:
  % \disegno[4]{\rcom{-10}{+10}{-10}{+10}{color=gray!50, very thin, step=1}}
  \def \dimensione{#1}
  \def \grafico{#2}
\begin{tikzpicture}[x=\dimensione mm, y=\dimensione mm, smooth]
  \grafico
\end{tikzpicture}
}

\newcommand{\rcom}[5]{% Riferimento Cartesiano Ortogonale Monometrico: x-y.
  % Esempio di chiamata:
  %% \disegno{\rcom{-7}{+7}{-11}{+10}{gray!50, very thin, step=1}}
  \def \xmi{#1}
  \def \xma{#2}
  \def \ymi{#3}
  \def \yma{#4}
  \def \griglia{#5}
  \draw[#5] (\xmi-0.3, \ymi-0.3) grid (\xma+0.3, \yma+0.3); % Griglia
  \begin{scope}[-{Stealth[length=2mm, open, round]}, black] % Assi
    \draw (\xmi-0.3, 0) -- (\xma+0.5, 0) 
      node [below, xshift=-3pt] {\(x\)};
    \draw (0, \ymi-0.3) -- (0, \yma+0.5) 
      node [left, yshift=-3pt] {\(y\)};
  \end{scope}
}

%========================
% Grafici
%========================
% 
% \newcommand{\xbar}[7]{
%   % example:
%   % \disegno{\xbar{0.7}{1.5}{a_1}{gray!50}{blue!50!black}{red}{0}}
%   \def \x{#1}
%   \def \y{#2}
%   \def \lx{#3}
%   \def \colorline{#4}
%   \def \colorpoint{#5}
%   \def \colorlabel{#6}
%   \def \lbelow{#7}
%   \draw [dotted, \colorline]
%         (\x, 0) node [\colorlabel, below=\lbelow] {\(\lx\)} -- (\x, \y);
%   \filldraw (\x, \y) [\colorpoint] circle(1.5pt);
% }
% 
% \def \puntipartizionen{4.17, 5.66, 5.89, 5.28, 4.25, 3.22, 2.61, 2.84, 4.33}
% \def \puntipartizionevuoti{(4, 4.88), (7, 2.19)}

\newcommand{\puntigrafico}{% Solo i punti evidenziati nel grafico precedente
  \def \fa{.07*x*x*x-1.05*x*x+4.15*x+1}
  \def \mix{0}
  \def \max{10}
  \def \miy{0}
  \def \may{8}
  \disegno{
    \rcom{\mix}{\max}{\miy}{\may}{color=gray!50, very thin, step=1}
    \tkzInit[xmin=\mix-0.3,xmax=\max+0.3,ymin=\miy-0.3,ymax=\may+0.3]
    \tkzFct[domain=\mix-0.3:\max+.3, ultra thick, color=orange!50!black]
           {\fa}
%     \foreach \yp [count = \xp] in \puntipartizionen{
%       \xbar{\xp}{\yp}{x_\xp}
%             {white!30!black}{color=blue!50!black}{color=blue!50!black}{0}};
  }
}

\newcommand{\graficodiscontinuo}{% 
  \def \fa{-0.62*x*x+3.34*x+1.46}
  \def \fb{-1.03*x+9.4}
  \def \fc{1/(-(1.65*(x-3.65)+0.66)+10)+2.35}
  \def \mix{0}
  \def \max{10}
  \def \miy{0}
  \def \may{8}
  \def \xdisca{4}
  \def \xdiscb{7}
  \def \asint{9.25}
  \disegno{
    \rcom{\mix}{\max}{\miy}{\may}{color=gray!50, very thin, step=1}
    \tkzInit[xmin=\mix-0.3,xmax=\max+0.3,ymin=\miy-0.3,ymax=\may+0.3]
    \begin{scope} [ultra thick, color=green!50!black]
      \tkzFct[domain=\mix-0.3:\xdisca] {\fa}
      \tkzFct[domain=\xdisca:\xdiscb] {\fb}
      \tkzFct[domain=\xdiscb:\asint] {\fc}
      \tkzFct[domain=\asint+0.1:\max+0.3] {\fc}
    \end{scope}
%     \foreach \yp [count = \xp] in \puntipartizionen{
%       \xbar{\xp}{\yp}{x_\xp}
%             {white!30!black}{color=blue!50!black}{color=blue!50!black}{0}};
%     \foreach \punto in \puntipartizionevuoti{
%       \filldraw \punto [fill=white] circle(1.5pt);}
  }
}


%========================
% Documento
%========================
\begin{document}

\scalebox{1}{\puntigrafico}
\scalebox{1}{\graficodiscontinuo}

\end{document}
