% (c) 2017 Bruno Stecca
% (c) 2017 Daniele Zambelli - daniele.zambelli@gmail.com
% 
% Tutti i grafici per il capitolo relativo agli integrali
% 
% 

\newcommand{\areasottesasegmento}{% Area sottesa a un segmento
  \disegno{
    \coordinate (a) at (2.5, 4);
    \coordinate (xa) at (2.5, 0);
    \coordinate (ya) at (0, 4);
    \coordinate (b) at (4.3, 5.2);
    \coordinate (xb) at (4.3, 0);
    \coordinate (yb) at (0, 5.2);

    \fill [top color=green!30!black!20,bottom color=green!50!black!10] 
    (a) -- (b) -- (xb) -- (xa) -- cycle;

    \rcom{-1}{+6}{-1}{+6}{gray!50, very thin, step=1}
    
    \draw [thick] (a) -- (b);
    \filldraw (a) circle (1.5pt) node [above left] {A};
    \filldraw (b) circle (1.5pt) node [above left] {B};

    \begin{scope}[dotted]
    \draw [-] (a) -- (xa) node [below] {$a$};
    \draw [-] (a) -- (ya) node [left] {$y_A$};
    \draw [-] (b) -- (xb) node [below] {$b$};
    \draw [-] (b) -- (yb) node [left] {$y_B$};
    \end{scope}
    }
}

\newcommand{\areasottesasegmenti}{% Area sottesa a un segmento
  \disegno{
    \rcom{-1}{+6}{-1}{+8}{gray!50, very thin, step=1}
    \foreach \xa/\y in {2/5, 2.5/4, 3/6, 3.5/3, 4/7, 4.5/5}{
      \fill [top color=green!30!black!20,bottom color=green!50!black!10] 
      (\xa, \y) -- (\xa+.5, \y) -- (\xa+.5, 0.015) -- (\xa, 0.015) -- cycle;
      \draw [thick, cap=butt] (\xa, \y) -- (\xa+.5, \y);
      \draw [very thin](\xa,\y) -- (\xa,0.018) (\xa+.5,\y) -- (\xa+.5,0.018);
    }
  }
}

\def \definizionilinea{
    \def \xi{-0.3};
    \def \yi{6.7};
    \def \xf{10.3};
    \def \yf{0.5};
    \def \xa{0.4};
    \def \ya{4.9};
    \def \xb{8.8};
    \def \yb{5.55};
    \coordinate (i) at (\xi, \yi);
    \coordinate (f) at (\xf, \yf);
    \coordinate (a) at (\xa, \ya);
    \coordinate (b) at (\xb, \yb);
    \coordinate (ctrli) at (3, -4);
    \coordinate (ctrlf) at (7, 17);
    \def \linea{(i) .. controls (ctrli) and (ctrlf) .. (f)}
}

\newcommand{\areasottesacurva}{% Area sottesa ad una curva.
  \disegno{
    \definizionilinea
    \begin{scope}
      \clip (\xa, 0) rectangle (\xb, 8);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      \linea -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}
    
    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}

    \begin{scope}
    \draw [-] (a) -- (\xa, 0) node [below] {$a$};
    \draw [-] (b) -- (\xb, 0) node [below] {$b$};
    \node at (4.5, 2.5) {\(\mathcal{A}(a;~b)\)};
    \end{scope}
    }
}

\newcommand{\propradditiva}{% Propr. additiva per area sottesa ad una curva.
  \disegno{
    \definizionilinea
    \def \xc{5.5};
    \def \yc{6.25};
    \coordinate (c) at (\xc, \yc);

    \begin{scope}
      \clip (\xa, 0) rectangle (\xb, 8);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      \linea -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}
    
    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}

    \begin{scope}
    \draw [-] (a) -- (\xa, 0) node [below] {$a$};
    \draw [-] (c) -- (\xc, 0) node [below] {$t$};
    \draw [-] (b) -- (\xb, 0) node [below] {$b$};
    \node at (3, 2.5) {\(\mathcal{A}(a;~t)\)};
    \node at (7.2, 2.5) {\(\mathcal{A}(t;~b)\)};
    \end{scope}
    }
}

\newcommand{\arearettangolare}[3]{% Rettangolo.
  \disegno{
    \definizionilinea
    \def \xm{#1};
    \def \ym{#2};
    \def \lm{#3};

    \begin{scope}
      \clip (\xa, 0) rectangle (\xb, 8);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      (\xa, 0) rectangle (\xb, \ym);
    \end{scope}

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}
    
    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}

    \begin{scope}[thin]
    \draw  (\xa, 0) node [below] {$a$} -- (\xa, \ym) -- 
           (\xb, \ym)  -- (\xb, 0) node [below] {$b$};
    \draw [densely dotted] (\xa, \ym) -- (0, \ym) node [left] {$y_{\lm}$};
    \node at (4.5, 2.5) {\(\mathcal{A}_{\lm}(a;~b)\)};
    \end{scope}
    }
}

\newcommand{\areaminore}{% Rettangolo minore.
  \arearettangolare{2}{3.49}{mi}
}

\newcommand{\areamaggiore}{% Rettangolo maggiore.
  \arearettangolare{7}{7.12}{ma}
}

\newcommand{\sommariemann}{% Somma di Riemann.
  \disegno{
    \definizionilinea
    \def \dx{1};
%     \def \ym{2};
%     \def \lm{3};

    \foreach \xa/\y in {0.4/4.9, 1.4/3.65, 2.4/3.57, 3.4/4.17, 4.4/5.15, 
                        5.4/6.2, 6.4/6.9, 7.4/7.06}{
      \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (\xa, \y) -- (\xa+\dx, \y) -- (\xa+\dx, 0.015) -- (\xa, 0.015) -- cycle;
      \draw [thick, cap=butt] (\xa, \y) -- (\xa+\dx, \y);
      \draw [very thin](\xa,\y) -- (\xa,0.015) (\xa+\dx,\y) -- 
                       (\xa+\dx,0.015);
    }
    \def \y{6.25}
    \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (8.43, \y) -- (\xb, \y) -- (\xb, 0.015) -- (8.43, 0.015) -- cycle;

    \draw [thick, cap=butt] (8.4, \y) -- (\xb, \y);
    \draw [very thin] (\xb, \y) -- (\xb, 0.015);

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}

    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}
    
    \node at (\xa, 0) [below, yshift=-1.2em] {$a$};
    \node at (\xb, 0) [below, yshift=-1em] {$b$};
    \foreach \n in {0,1,2}
      \node at (\xa+\n*\dx, 0) [below] {$t_\n$};
    \foreach \n in {3.5,6.5}
      \node at (\xa+\n*\dx, 0) [below, yshift=-6pt] {$\dots$};
    \node at (\xa+5*\dx, 0) [below] {$t_i$};
    \node at (\xa+8*\dx, 0) [below] {$t_h$};

    }
}

\newcommand{\riemanninferiore}{% Somma di Riemann inferiore.
  \disegno{
    \definizionilinea
    \def \dx{1};
%     \def \ym{2};
%     \def \lm{3};

    \foreach \xa/\y in {0.4/3.66, 1.4/3.45, 2.4/3.57, 3.4/4.17, 4.4/5.15, 
                        5.4/6.15, 6.4/6.9, 7.4/6.25}{
      \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (\xa, \y) -- (\xa+\dx, \y) -- (\xa+\dx, 0.015) -- (\xa, 0.015) -- cycle;
      \draw [thick, cap=butt] (\xa, \y) -- (\xa+\dx, \y);
      \draw [very thin](\xa,\y) -- (\xa,0.015) (\xa+\dx,\y) -- 
                       (\xa+\dx,0.015);
    }
    \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (8.43, 5.55) -- (\xb, 5.55) -- (\xb, 0.015) -- (8.43, 0.015) -- cycle;

    \draw [thick, cap=butt] (8.4, 5.55) -- (\xb, 5.55);
    \draw [very thin] (\xb, 5.55) -- (\xb, 0.015);

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}

    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}
    
    \node at (\xa, 0) [below, yshift=-1.2em] {$a$};
    \node at (\xb, 0) [below, yshift=-1em] {$b$};
    \foreach \n in {0,1,2}
      \node at (\xa+\n*\dx, 0) [below] {$t_\n$};
    \foreach \n in {3.5,6.5}
      \node at (\xa+\n*\dx, 0) [below, yshift=-6pt] {$\dots$};
    \node at (\xa+5*\dx, 0) [below] {$t_i$};
    \node at (\xa+8*\dx, 0) [below] {$t_h$};

    }
}

\newcommand{\riemannsuperiore}{% Somma di Riemann superiore.
  \disegno{
    \definizionilinea
    \def \dx{1};
%     \def \ym{2};
%     \def \lm{3};

    \foreach \xa/\y in {0.4/4.9, 1.4/3.67, 2.4/4.17, 3.4/5.15, 4.4/6.2, 
                        5.4/6.9, 6.4/7.15, 7.4/7.06}{
      \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (\xa, \y) -- (\xa+\dx, \y) -- (\xa+\dx, 0.015) -- (\xa, 0.015) -- cycle;
      \draw [thick, cap=butt] (\xa, \y) -- (\xa+\dx, \y);
      \draw [very thin](\xa,\y) -- (\xa,0.015) (\xa+\dx,\y) -- 
                       (\xa+\dx,0.015);
    }
    \def \y{6.25}
    \fill [top color=green!30!black!20,bottom color=green!50!black!10]
      (8.43, \y) -- (\xb, \y) -- (\xb, 0.015) -- (8.43, 0.015) -- cycle;

    \draw [thick, cap=butt] (8.4, \y) -- (\xb, \y);
    \draw [very thin] (\xb, \y) -- (\xb, 0.015);

    \rcom{0}{+10}{0}{+8}{gray!50, very thin, step=1}

    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 8);
      \draw [thick] \linea;
    \end{scope}
    
    \node at (\xa, 0) [below, yshift=-1.2em] {$a$};
    \node at (\xb, 0) [below, yshift=-1em] {$b$};
    \foreach \n in {0,1,2}
      \node at (\xa+\n*\dx, 0) [below] {$t_\n$};
    \foreach \n in {3.5,6.5}
      \node at (\xa+\n*\dx, 0) [below, yshift=-6pt] {$\dots$};
    \node at (\xa+5*\dx, 0) [below] {$t_i$};
    \node at (\xa+8*\dx, 0) [below] {$t_h$};

    }
}

\newcommand{\funzint}[5]{% Area sottesa ad una costante.
  \disegno{
    \def \k{#1};
    \def \xa{#2};
    \def \xxi{#3};
    \def \xxf{#4};
    \def \label{#5};
    \def \xi{-1.3};
    \def \xf{7.3};
    \begin{scope}
      \clip (\xa, 0) rectangle (\xf, 5);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      (\xi, \k) -- (\xf, \k) -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{-1}{+7}{0}{+6}{gray!50, very thin, step=1}
    
    \draw [thick] (\xi, \k) -- (\xf, \k);
    \node at (0, \k) [above left] {\(\label\)};

    \draw [-] (\xa, \k) -- (\xa, 0) node [below, yshift=-4pt] {$a$};
    \foreach \x in {\xxi,...,\xxf}
      \draw [-] (\x, \k) -- (\x, 0) node [below, yshift=-2pt] {$\x$};
    \draw [-] (6.7, \k) -- (6.7, 0) node [below, yshift=-4pt] {$x$};
    }
}

\newcommand{\funzintk}[4]{% Area sottesa ad una costante.
  \disegno{
    \def \k{#1};
    \def \xa{#2};
    \def \x{#3};
    \def \label{#4};
    \def \xi{-2.3};
    \def \xf{7.3};
    \begin{scope}
      \clip (\xa, 0) rectangle (\xf, 5);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      (\xi, \k) -- (\xf, \k) -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{-2}{+7}{0}{+5}{gray!50, very thin, step=1}
    
    \draw [thick] (\xi, \k) -- (\xf, \k);
    \node at (0, \k) [above left] {\(\label\)};

    \draw [-] (\xa, \k) -- (\xa, 0) node [below, yshift=-4pt] {$a$};
    \draw [-] (\x, \k) -- (\x, 0) node [below, yshift=-2pt] {$x$};
    }
}

\newcommand{\funzintx}[5]{% Area sottesa ad una costante.
  \disegno{
    \def \m{#1};
    \def \xa{#2};
    \def \xxi{#3};
    \def \xxf{#4};
    \def \label{#5};
    \def \xi{-0.3};
    \def \xf{8.3};
    \begin{scope}
      \clip (0, 0) rectangle (\xf, 10.3);
      \fill [top color=green!30!black!20, bottom color=green!50!black!10] 
      (\xi, \m*\xi) -- (\xf,  \m*\xf) -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{-1}{+8}{0}{+9}{gray!50, very thin, step=1}
    
    \begin{scope}
      \clip (-0.3, -0.3) rectangle (\xf, 10.3);
      \draw [thick] (\xi, \m*\xi) -- (\xf,  \m*\xf);
    \node at (7, 8.5) {\(\label\)};
    \end{scope}

    \draw [-] (\xa, \m*\xa) -- (\xa, 0) node [below, yshift=-4pt] {$a$};
    \foreach \x in {\xxi,...,\xxf}
      \draw [-] (\x, \m*\x) -- (\x, 0) node [below, yshift=-2pt] {$\x$};
    }
}

\newcommand{\intfinox}{% Area sottesa fino a x.
  \disegno{
    \def \k{2};
    \def \xi{-4.3};
    \def \yi{2};
    \def \xf{7.3};
    \def \yf{4};
    \def \xa{2.6};
    \def \ya{5.10};
    \def \x{5.5};
    \def \y{5.55};
    \def \label{p};
    \def \linea{(\xi, \yi) .. controls (-2, -2) and (3, 10) .. (\xf, \yf)};
    \begin{scope}
      \clip (\xi, 0) rectangle (\xa, 6);
      \fill [left color=red!10!black!5, right color=red!60!black!20] 
        \linea -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}
    \begin{scope}
      \clip (\xa, 0) rectangle (\xf, 6);
      \fill [top color=green!40!black!30, bottom color=green!40!black!5] 
        \linea -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}

    \rcom{-4}{+7}{0}{+7}{gray!50, very thin, step=1}
    
    \draw [thick] \linea;
    \node at (6.5, 5.5) {\(f\)};

    \draw [-] (\xa, \ya) -- (\xa, 0) node [below, yshift=-4pt] {$a$};
    \draw [-] (\x, \y) -- (\x, 0) node [below, yshift=-2pt] {$x$};
    \node at (0.5, 1.5) {\(\mathcal{S}(\dots;~a)\)};
    \node at (4.2, 1.5) {\(\mathcal{S}(a;~x)\)};
    }
}

\newcommand{\teoremafonda}{% Area sottesa fino a x.
  \disegno{
    \def \k{2};
    \def \xi{-4.3};
    \def \yi{2};
    \def \xf{7.3};
    \def \yf{4};
    \def \xa{2.6};
    \def \ya{5.10};
    \def \x{3.4};
    \def \y{5.55};
    \def \label{p};
    \def \linea{(\xi, \yi) .. controls (-2, -2) and (3, 10) .. (\xf, \yf)};
    \begin{scope}
      \clip (\xi, 0) rectangle (\xf, 6);
      \fill [left color=red!10!black!5, right color=red!60!black!20] 
        \linea -- (\xf, 0) -- (\xi, 0) -- cycle;
    \end{scope}
    \begin{scope}
      \clip (\xa, 0) rectangle (\x, 6);
      \fill [top color=green!40!black!30, bottom color=green!40!black!5] 
        (\xa, 0) -- (\xa, \ya) -- (\x, \ya) -- (\x, 0) -- cycle;
    \end{scope}

    \rcom{-4}{+7}{0}{+7}{gray!50, very thin, step=1}
    
    \draw [thick] \linea;
    \node at (6.5, 5.5) {\(f\)};

    \draw [-] (\xa, \ya) -- (\xa, 0) node [below, xshift=-3pt] {$x$}
              (\xa, \ya) -- (\x, \ya)
              (\x, \ya) -- (\x, 0) node [below, xshift=-4pt] {$dx$};
    \draw [dotted] (\xa, \ya) -- (0, \ya) node [left] {$f(x)$};
    }
}

\newcommand{\intdef}{% Area sottesa ad una funzione da a a b.
  \disegno{
    \def \xa{-1};
    \def \ya{4};
    \def \xb{2};
    \def \yb{7};
    \def \linea{(-1.68, 8.3) parabola bend (.25, 0.875) (2.18, 8.3)};

    \begin{scope}
      \clip (\xa, 0) rectangle (\xb, \yb);
      \fill [top color=green!40!black!30, bottom color=green!60!black!20] 
        \linea -- (\xb, 0) -- (\xa, 0) -- cycle;
    \end{scope}
    
    \rcom{-3}{+5}{0}{+8}{gray!50, very thin, step=1}
    
    \node at (-1.9, 7.5) {\(f\)};
    \draw [thick] \linea;
    \draw [-] (\xa, \ya) -- (\xa, 0) node [below] {$a$};
    \draw [-] (\xb, \yb) -- (\xb, 0) node [below] {$b$};
    }
}
