% (c) 2017 Bruno Stecca
% (c) 2017 Daniele Zambelli - daniele.zambelli@gmail.com
% 
% Tutti i grafici per il capitolo relativo alle derivate
% 
% 

\newcommand{\parabolaetangente}{% 
  % Parabola e tangenti.
  \rcom{-2}{+10}{-1}{+6}{gray!50, very thin, step=1}
  \tkzInit[xmin=-1.3,xmax=+10.3,ymin=-1.3,ymax=+7.3]
  \tkzFct[domain=-10:+10.3, ultra thick, color=blue!50!black]
         {-1./4.*x**2+2*x+1}
  \tkzFct[domain=5.2:+10.3, ultra thick, color=red!50!black]{-2.*x+17}
  \begin{scope}[color=red!50!black]
  \coordinate (b) at (+8, +1);
  \filldraw (b) circle (1.5pt); 
  \node at (b) [color=black, right] {\(P \approx P'\)};
  \end{scope}
}

\newcommand{\parabolaetangentea}{% 
    % Parabola e tangenti.
  \disegno[4]{
  \parabolaetangente
    \microscopio{(8, 1)}{1.5}{165}{0}{2}{(4.5, -1)}{}
    \draw [color=violet!80!black, ultra thick] (6, 0) -- (4.2, 3.3); 
    \filldraw (4.58, 2.6) circle (1.5pt) node [color=black, left] {\(P\)};
    \filldraw (5.56, .8) circle (1.5pt) node [color=black, left] {\(P'\)};
  }
}

\newcommand{\parabolaetangenteb}{% 
    % Parabola e tangenti.
  \disegno[4]{
    \parabolaetangente
    \microscopio{(8, 1)}{1.5}{165}{0}{2}{(4.5, -1)}{}
    \draw [color=violet!80!black, ultra thick] (6, 0) -- (4.2, 3.3); 
    \draw [color=black]
          (4.5, 2.6) -- (4.5, .2) -- (4.5, .8) -- (5.5, .8) -- (5.5, .2);
    \draw [color=black] 
          (3.7, 1.5) node {\footnotesize \(\Delta y\)} 
          (5, .3) node {\footnotesize \(\Delta x\)};
    \filldraw (4.58, 2.6) circle (1.5pt) 
                          node [color=black, above right=-1.5mm, scale=.9] 
                               {\(P\)};
    \filldraw (5.56, .8) circle (1.5pt) 
                         node [color=black, above right=-1.5mm, scale=.9] 
                         {\(P'\)};
  }
}

\newcommand{\incremento}{% 
  % definita in intervallo 0-inf.
  \disegno[3.5]{
  \rcom{-1}{+8}{-5}{+7}{gray!50, very thin, step=1}
  \tkzInit[xmin=-1.3, xmax=+8.3, ymin=-5.3, ymax=+7.3]
  \tkzFct[ultra thick, color=Green!50!black, domain=-1.3:+8.3]
          {.25*x*x-x-3}
  \draw [dashed, Blue!50!] (3, -3.75) -- (0, -3.75) 
        node [left] {\(f(3)\)};
  \draw [<->, ultra thick, dashed, color=Red!50!black] 
        (0, -3.75) -- (0, 2.25);
  \draw [dashed, Blue!50!black] (7, 2.25) -- (0, 2.25) 
        node [left] {\(f(7)\)};
  \node at (-1.8, -0.7) [rotate=90, Red!50!black] {\(f(7)-f(3)\)};
  \node at (3, 0) [below, Blue!50!black] {\(3\)};
  \node at (7, 0) [below, Blue!50!black] {\(7\)};
    }
}

% 
% \clip[draw] (0.5,0.5) circle (.6cm);
% 

\newcommand{\micx}[8]{% 
  % interno del microscopio posto sull'asse x.
  \def \basexa{#1} \def \basexb{#2} \def \basey{#3}
  \def \xa{#4}     \def \xb{#5}     \def \yab{#6}
  \def \eta{#7}    \def \etb{#8}
  \draw (\basexa, \basey) -- (\basexb, \basey);
  \fill [Cyan!50]  (\xa, \yab) -- (\xa, \basey) -- 
                   (\xb, \basey) -- (\xb, \yab) -- cycle;
  \draw [dashed] (\xa, \yab) -- (\xa, \basey) 
        node [below, xshift=-1mm] {\eta};
  \draw [dashed] (\xb, \yab) -- (\xb, \basey) 
        node [below, xshift=+2.5mm] {\etb};
}

\newcommand{\micf}[7]{% 
  % interno del microscopio posto sulla funzione.
  \def \basea{#1}  \def \baseb{#2} \def \puntobase {#3} 
  \def \puntoa{#4} \def \puntob{#5} \def \dx{#6} \def \df{#7}
  \path \puntoa node(pa) {} \puntob node(pb) {} \puntobase node(base) {};
  \fill [fill=Cyan!50] 
        (pa -| base) -- (pa |- pa) -- (pa |- base) -- 
        (pb |- base) -- (pb |- pb) -- (pb -| base) -- cycle;
  \draw [ultra thick, color=Green!50!black] \basea -- \baseb;
  \draw [dashed] (pa -| base) -- (pa |- pa) -- (pa |- base)
        (pb -| base) -- (pb |- pb) -- (pb |- base);
  \draw [thick, color=Red!50!black] (pa |- pa) -- (pb |- pa)
        node [midway, below] {\dx}; %{\(\epsilon\)};
  \draw [thick, color=Red!50!black] (pb |- pb) -- (pb |- pa)
        node [midway, right] {\df}; % {\(df(x)_7\)};
}

\newcommand{\micy}[8]{% 
  % interno del microscopio posto sull'asse x.
  \def \baseya{#1} \def \baseyb{#2} \def \basex{#3}
  \def \ya{#4}     \def \yb{#5}     \def \xab{#6}
  \def \eta{#7}    \def \etb{#8}
  \fill [Cyan!50]  (\xab, \ya) -- (\basex, \ya) -- 
                   (\basex, \yb) -- (\xab, \yb) -- cycle;
  \draw (\basex, \baseya) -- (\basex, \baseyb);
  \draw [dashed] (\basex, \ya) node [left] {\eta} -- (\xab, \ya);
  \draw [dashed] (\basex, \yb) node [left] {\etb} -- 
        (\xab, \yb);
}

\newcommand{\differenziale}{% 
  % definita in intervallo 0-inf.
  \disegno{
  \rcom{-1}{+8}{-5}{+7}{gray!50, very thin, step=1}
  \tkzInit[xmin=-1.3, xmax=+8.3, ymin=-5.3, ymax=+7.3]
  \tkzFct[ultra thick, color=Green!50!black, domain=-1.3:+8.3]
          {.25*x*x-x-3}
  \draw [dashed] (7, 2.25) -- (7, 0) node [below] {\(7\)};
  \draw [dashed] (7, 2.25) -- (0, 2.25) node [left] {\(f(7)\)};
  \microscopio{(7, 0)}{1.5}{-60}{150}{2}{(11, -.3)}{\(\times \infty\)}
  \micx{7.65}{11.3}{-3.1}{9}{10}{-0.35}{\(7\)}{\(7+\epsilon\)}
  \microscopio{(7, 2.25)}{.5}{0}{180}{2}{(11, 4.2)}{\(\times  \infty\)}
  \micf{(8.7, .4)}{(10.3, 4.1)}{(7.8, 0.34)}{(9, +1.1)}{(10, 3.4)} 
      {\(\epsilon\)}{\(df(7)\)}
  \microscopio{(0, 2.25)}{.5}{0}{180}{2}{(4, 4.2)}{\(\times  \infty\)}
  \micy{0.25}{4.25}{2.51}{1.1}{3.4}{4.2}{\(f(7)\)}{\(f(7+\epsilon)\)}
    }
}

\newcommand{\diffcostante}{% diff. di f costante
  \disegnod{4.5}{
  \rcom{-2}{+8}{-3}{+5}{gray!50, very thin, step=1}
  \tkzInit[xmin=-2.3, xmax=+8.3, ymin=-4.3, ymax=+4.3]
  \tkzFct[thick, color=Maroon!50!black, domain=-2.3:8.3]{2.8}
  \microscopio{(0.7, 2.8)}{1}{-50}{-200}{2.5}{(5.8, -1.3)}
              {\(\times \infty\)}
  \micf{(1.2, 1.5)}{(6.2, 1.5)}{(3, -1.2)}{(3, +1.5)}{(4, 1.5)}
      {\(\epsilon\)}{\(df(x)\)}
  }
}

\newcommand{\rettabisettrice}{% m=1
  \disegnod{4.5}{
  \rcom{-6}{+6}{-6}{+6}{gray!50, very thin, step=1} 
  \tkzInit[xmin=-6.3, xmax=+6.3, ymin=-6.3, ymax=6.3]
  \tkzFct[ultra thick, color=Maroon!50!black, domain=-6.3:6.3]{1*x}
  \draw [dashed] (0, 1.5) -- (1.5,1.5) -- (1.5, 0) -- (1.5,1.5);
  \microscopio{(1.5, 0)}{1.5}{-35}{145}{2}{(6, -4.3)}{\(\times \infty\)}
  \micx{2.4}{6.3}{-2.3}{3.9}{4.9}{-0.1}{\(x\)}{\(x+\epsilon\)}
  \microscopio{(1.5, 1.5)}{1}{0}{200}{2}{(6, 4.3)}{\(\times \infty\)}
  \micf{(2.9, .9)}{(5.7, 3.7)}{(2.45, 0.25)}{(3.9, 1.9)}{(4.9, 2.9)}
      {\(\epsilon\)}{\(df(x)\)}
  \microscopio{(0, 1.5)}{1}{140}{0}{2}{(-4.5, 4.3)}{\(\times \infty\)}
  \micy{0.15}{4.15}{-2.8}{1.9}{2.9}{-0.9}{\(y=x\)}{\(y+\epsilon\)}
     }    
  }


\newcommand{\radice}{% 
    % definita in intervallo 0-inf.
    \disegnod{4.5}{
    \rcom{-1}{+5}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+6.3, ymin=-1.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Green!60!black, domain=0:+5.3]{sqrt(x)}
    }
}

\newcommand{\iperbole}{% 
    % discontinuità in f(x).
    \disegnod{4.5}{
    \rcom{-5}{+5}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-5.3, xmax=+5.3, ymin=-5.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-5.3:0]{1/x}
     \tkzFct[ultra thick, color=Maroon!50!black, domain=0:+5.3]{1/x}
    }
}

\newcommand{\iperbolequad}{% 
    % discontinuità in f(x).
    \disegnod{4.5}{
    \rcom{-5}{+5}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-5.3, xmax=+5.3, ymin=-5.3, ymax=+5.3]
    \begin{scope} [ultra thick, color=Cyan!50!black]
      \tkzFct[domain=-5.3:-1]{1/(x*x-1)}
      \tkzFct[domain=-1:+1]{1/(x*x-1)}
      \tkzFct[domain=+1:+5.3]{1/(x*x-1)}
    \end{scope}
    }
}

\newcommand{\salto}{% discontinuità a salto.
    \disegnod{4}{
    \rcom{-5}{+5}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-5.3, xmax=+5.3, ymin=-5.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-5.3:1.95]{x-1}
     \tkzFct[ultra thick, color=Maroon!50!black, domain=2:+5.3]{x+1}
     \filldraw [Maroon!50!black] (2, 3) circle (1.8pt);
     \draw [Maroon!50!black] (2, 1) circle (1.8pt);
    }
}

\newcommand{\incrementaleprodotto}{% rettangolo con gnomone fni
  \def \xa{0}
  \def \ya{0}
  \def \xb{6}
  \def \yb{4}
  \def \dx{2}
  \def \dy{1}
  \def \xc{\xb+\dx}
  \def \yc{\yb+\dy}

  \disegno{
    \fill [Cyan!50] 
%      (\xb, \yb) -- (\xc, \yb) -- (\xc, \yc) -- (\xb, \yc) -- cycle;
      (\xa, \yb) -- (\xc, \yb) -- (\xc, \yc) -- (\xa, \yc) -- cycle;
   \fill [Cyan!50]
      (\xb, \ya) -- (\xc, \ya) -- (\xc, \yb) -- (\xb, \yb) -- cycle;
    \draw (\xa, \ya) node [below] {\(0\)} node [left] {\(0\)} -- 
    (\xb, \ya) node [below] {\(b\)} -- 
    (\xc, \ya) node [below] {\(b + \Delta b\)} --
    (\xc, \yc) -- 
    (\xa, \yc) node [left] {\(h + \Delta h\)} -- 
    (\xa, \yb) node [left] {\(h\)} -- cycle;
    \draw (\xb, \ya) -- (\xb, \yc) (\xa, \yb) -- (\xc, \yb);
    \draw (\xb / 2, \yb / 2) node {\(b \cdot h\)};
    \begin{scope}[font=\fontsize{6}{6}] %\scriptsize % \small
	    \draw (\xb / 2, \yb + \dy / 2) node {\(b \cdot \Delta h\)};
	    \draw (\xb + \dx / 2, \yb / 2) node [rotate=90] {\(\Delta b \cdot h\)};
	    \draw (\xb + \dx / 2, \yb + \dy / 2) node {\(\Delta b \cdot \Delta h\)};
    \end{scope}
    }
}

\newcommand{\differenzialeprodotto}{% rettangolo con gnomone i
  \def \xa{0}
  \def \ya{0}
  \def \xb{6}
  \def \yb{4}
  \def \d{2}
  \def \xc{\xb+\d}
  \def \yc{\yb+\d}

  \disegno{
    \draw (\xa, \ya) node [below] {\(0\)} node [left] {\(0\)} -- 
    (\xb, \ya) node [below] {\(b \sim b + db\)} -- 
    (\xb, \yb) -- 
    (\xa, \yb) node [left] {\(h \sim h + dh\)} -- cycle;
    \microscopio{(\xb, \yb)}{2}{120}{-50}{2}{(\xb, 9)}{\(\times 10^9\)}
    \draw (.3*\xb, 1.82*\yb) -- (0.65*\xb, 1.82*\yb) -- (0.65*\xb, 1.36*\yb);
    \microscopio{(\xb, \yb)}{2}{30}{240}{2}{(1.85*\xb, 8)}{\(\times \infty\)}
    \fill [Cyan!50] 
      (1.12*\xb, 1.6*\yb) -- (1.65*\xb, 1.6*\yb) -- 
      (1.65*\xb, 1.8*\yb) -- (1.12*\xb, 1.8*\yb) -- cycle;
     \fill [Cyan!50] 
      (1.51*\xb, 1.65*\yb) -- (1.65*\xb, 1.65*\yb) -- 
      (1.65*\xb, 1.27*\yb) -- (1.51*\xb, 1.2*\yb) -- cycle;  
    \draw (1.12*\xb, 1.8*\yb) -- (1.65*\xb, 1.8*\yb)
          (1.12*\xb, 1.6*\yb) -- (1.65*\xb, 1.6*\yb)
          (1.5*\xb, 1.8*\yb) -- (1.5*\xb, 1.2*\yb)
          (1.65*\xb, 1.8*\yb) -- (1.65*\xb, 1.27*\yb);
    \draw (\xb / 2, \yb / 2) node {\(b \cdot h\)};
    \begin{scope}[font=\fontsize{6}{6}] %\scriptsize % \small
	    \draw (1.35*\xb, 1.7*\yb) node{\(b \cdot dh\)};
	    \draw (1.57*\xb, 1.4*\yb) node [rotate=90] {\(db \cdot h\)};
	    \draw (1.63*\xb, 1.85*\yb) node  {\(db \cdot dh\)};   
    \end{scope}
    }
}

\newcommand{\differenzialerapporto}{% rettangolo con gnomone i
  \def \xa{0}
  \def \ya{0}
  \def \xb{6}
  \def \yb{4}
  \def \d{2}
  \def \xc{\xb+\d}
  \def \yc{\yb+\d}

  \disegno{
    \draw (\xa, \ya) node [below] {\(0\)} node [left] {\(0\)} -- 
    (\xb, \ya) node [below] {\(b \sim b + db\)} -- 
    (\xb, \yb) -- 
    (\xa, \yb) node [left] {\(h \sim h + dh\)} -- cycle;
    \microscopio{(\xb, \yb)}{2}{120}{-50}{2}{(\xb, 9)}{\(\times 10^9\)}
    \draw (.3*\xb, 1.82*\yb) -- (0.65*\xb, 1.82*\yb) -- (0.65*\xb, 1.36*\yb);
    \microscopio{(\xb, \yb)}{2}{30}{240}{2}{(1.85*\xb, 8)}{\(\times \infty\)}
    \fill [Cyan!50] 
      (1.13*\xb, 1.6*\yb) -- (1.65*\xb, 1.6*\yb) -- 
      (1.65*\xb, 1.8*\yb) -- (1.13*\xb, 1.8*\yb) -- cycle;
    \draw (1.12*\xb, 1.8*\yb) -- (1.65*\xb, 1.8*\yb)
          (1.12*\xb, 1.6*\yb) -- (1.65*\xb, 1.6*\yb)
          (1.5*\xb, 1.8*\yb) -- (1.5*\xb, 1.2*\yb)
          (1.65*\xb, 1.8*\yb) -- (1.65*\xb, 1.27*\yb);
    \draw (\xb / 2, \yb / 2) node {\(\mathit{A}\)};
    \draw (\xb +1, \yb/2) node {\(h=\frac{\mathit{A}}{b}\)};
    \begin{scope}[font=\fontsize{6}{6}] %\scriptsize % \small
	    \draw (1.87*\xb, 1.7*\yb) node{\(dh=d\quadra{\frac{\mathit{A}}{b}}\)};
	    \draw (1.57*\xb, 1.4*\yb) node [rotate=90] 
          {\(db \cdot \frac{\mathit{A}}{b}\)};
    \end{scope}
    }
}

\newcommand{\rettadueterzi}{% m=3/2.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-4}{+4}{gray!50, very thin, step=1}
 % rapp.incrementale   
    \filldraw (2, 2) circle (1.2pt)
              (3, 3.5) circle (1.2pt)
              (2.5, -1.1) node [rotate=90]{\(\Delta x=1\)}
              (0, 2.75) node [left]{\(\Delta y=\frac{3}{2}\)}    
              (-4, 1) node [right]{\(\frac{\Delta y}{\Delta x}=
              \frac{\frac{3}{2}}{1}=\frac{3}{2}\)};
     \fill [Cyan!50] 
      (0, 2) -- (0, 3.5) -- 
      (3, 3.5) -- (2, 2) -- cycle;
     \fill [Cyan!50] 
      (2, 0) -- (3, 0) -- 
      (3, 3.5) -- (2, 2) -- cycle;     
%retta
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-4.3, ymax=4.3]
    \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:4.3]{1.5*x-1}
    }
}

\newcommand{\rettamenounquarto}{% retta con m=-1/4.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-4}{+4}{gray!50, very thin, step=1}
% rapp.incrementale
    \fill [Cyan!50] 
      (-4, 1.5) -- (0, 1.5) -- 
      (0, 1) -- (-2, 1) -- cycle;
    \draw (-0.5, 1.25)[Black!, right]node {\(\Delta y=-\frac{1}{2}\)}; 
    \fill [Cyan!50] 
      (-4, 1.5) -- (-4, 0) -- 
      (-2, 0) -- (-2, 1) -- cycle;
    \draw (-3, -1.2) node [Black!, rotate=90] {\(\Delta x=2\)};    
    \filldraw [color=Black!50!black]
              (-4, 1.5) circle (1.2pt)
              (-2, 1) circle (1.2pt)
              (-4, 2.5) node [right]{\(\frac{\Delta y}{\Delta x}=
              \frac{-\frac{1}{2}}{2}=-\frac{1}{4}\)};
% retta              
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-4.3, ymax=+4.3]
    \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:4.3]{-.25*x+.5}              
    }
}

\newcommand{\retteorvert}{% m=0, m=inf.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-4}{+4}{gray!50, very thin, step=1}
        \draw [ultra thick, color=Maroon!50!black]
          (-4.3, -1.5) -- (4.3, -1.5);
    \draw [ultra thick, color=Green!60!black]
          (-2.8, -4.3) -- (-2.8, 4.3);
    \filldraw [color=Black!50!black]
              (-2.8, 3.5) circle (1.2pt)
              (-2.8, 2.5) circle (1.2pt)
              (0, 3) node {\(\frac{\Delta y}{\Delta x}=\frac{1}{0}=\)?};
    \filldraw (-1, -1.5) circle (1.2pt)
              (-2, -1.5) circle (1.2pt)
              (-1.5, -2) node  {\(\frac{\Delta y}{\Delta x}=\frac{0}{1}=0\)};
    \filldraw (1.5, -1.5) circle (1.2pt)
              (3.5, -1.5) circle (1.2pt)        
              (2.5, -0.8) node {\(\frac{\Delta y}{\Delta x}=\frac{0}{2}=0\)};
    }
}


\newcommand{\curvacubica}{% 
    % Rapporti incre. a una curva.
    \disegno{
    \rcom{-4}{+4}{-2}{6}{gray!50, very thin, step=1.0}
    \fill [Cyan!50] 
      (-3.6, 5) -- (-2, 2) -- (-3.6, 2) -- cycle
      (-2, 2) -- (-2, 3) -- (0, 3) -- cycle
      (0, 3) -- (2.35, 3.8) -- (2.35, 3) -- cycle
      (2.35, 3.8) -- (3.6, 3.8) -- (3.6, 1) -- cycle;
    \filldraw [color=Black] 
      (-3.6, 5) circle (1.2pt)  node [right] {A}
      (-2, 2) circle (1.2pt)    node [below] {B}
      (0, 3) circle (1.2pt)     node [above] {C}
      (2.35, 3.8) circle (1.2pt) node [above] {D}
      (3.6, 1) circle (1.2pt)  node [left] {E};
    \begin{scope}[ultra thick, color=Maroon!50!black]
      \tkzInit[xmin=-4., xmax=+4, xstep=1., ymin=-5,ymax=8]
      \tkzFct[domain=-4:+4]{-.12*x*x*x+x+3}
    \end{scope}  
    }
}

\newcommand{\secanticubica}{% 
    % secanti a una cubica.
    \disegno{
    \rcom{-4}{+4}{-2}{6}{gray!50, very thin, step=1.0}
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-2.3, ymax=+6.3]
    \tkzFct[thick, color=Cyan!50!black, domain=-4.3:4.3]{-1.9*x-1.8}   
    \tkzFct[thick, color=Cyan!50!black, domain=-4.3:4.3]{0.5*x+3} 
    \tkzFct[thick, color=Cyan!50!black, domain=-4.3:4.3]{0.33*x+3} 
    \tkzFct[thick, color=Cyan!50!black, domain=-4.3:4.3]{-2.32*x+9.3} 
  
   \filldraw [color=Black] 
      (-3.6, 5) circle (1.2pt)  node [right] {A}
      (-2, 2) circle (1.2pt)    node [below] {B}
      (0, 3) circle (1.2pt)     node [above] {C}
      (2.35, 3.8) circle (1.2pt) node [above] {D}
      (3.6, 1) circle (1.2pt)  node [left] {E};
    \begin{scope}[ultra thick, color=Maroon!50!black]
      \tkzInit[xmin=-4., xmax=+4, xstep=1., ymin=-5,ymax=8]
      \tkzFct[domain=-4:+4]{-.12*x*x*x+x+3}
    \end{scope}  
    }
}

\newcommand{\secantiparabola}{% 
    % definita in intervallo 0-inf.
    \disegnod{4.5}{
    \rcom{-1}{+5}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+6.3, ymin=-1.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Green!50!black, domain=0:+5.3]{-x*x+x+3}
    }
}

\newcommand{\secanticurva}{% 
  % Secanti ad una parabola nel punto (5; 4).
  \def \raggio{1.5pt}
  \disegno{
  \rcom{-10}{+10}{-1}{10}{gray!50, very thin, step=1}
    \tkzInit[xmin=-10.3,xmax=+10.3,ymin=-1.3,ymax=+10.3]
    \tkzFct{1.2*x-2}   % per AB
  \begin{scope}[ultra thick, color=Maroon!50!black]
    \tkzInit[xmin=-10.3,xmax=+10.3,ymin=-0.3,ymax=+10.3]
    \tkzFct[domain=-10:+10]{0.2*x*(x+2)-x+2}
  \end{scope}
  \begin{scope}[color=Black]
    \filldraw (5, 4) circle (2pt) node [above left] {A};
    \foreach \p/\n in {(4, 2.8)/\(P_7\), 
                      (3, 2)/\(P_6\), (1.5, 1.55)/\(P_5\)}
      \filldraw \p circle (\raggio) node [below, yshift=-1mm] {\n};
    \foreach \p/\n in {(0, 2)/\(P_4\), (-1.19, 3)/\(P_3\), 
                      (-2.5, 4.75)/\(P_2\), (-4, 7.6)/\(P_1\)}
      \filldraw \p circle (\raggio) node [below left, yshift=-1mm] {\n}; 
  \end{scope}
  \begin{scope}[thick, color=Cyan!50!black]
    \tkzInit[xmin=-10.3,xmax=+10.3,ymin=-1.3,ymax=+10.3, ]
    \tkzFct[domain=-10.3:+10.3]{1.2*x-2}   % per AB
    \tkzFct{x-1}       % per AC
    \tkzFct{0.7*x+.5}   % per AD
    \tkzFct{0.4*x+2}   % per AE
    \tkzFct{0.162*x+3.19}     % per AF
    \tkzFct{-0.1*x+4.5}  % per AG
    \tkzFct{-0.4*x+6}  % per AH  
  \end{scope}
  }
}

\newcommand{\secRD}{% 
  % Tangente ad una parabola nel punto (5; 4).
  \disegno{
  \rcom{-10}{+10}{-1}{10}{gray!50, very thin, step=1}
  \tkzInit[xmin=-10.3,xmax=+10.3,ymin=-1.3,ymax=+10.3]
  \tkzFct[ultra thick, color=Maroon!50!black,
          domain=-10.3:+10.3]{0.2*x*(x+2)-x+2} 
  \tkzFct[thick, color=Cyan!50!black] {1.4*x-3}
  \filldraw [color=Black] (5, 4) circle (2pt) node [below right] {A};
  \microscopio{(5, 4)}{3}{20}{230}{2}{(11.5, 8)}{\(\times \infty\)}
  \tkzInit[xmin=0,xmax=+10.2,ymin=0,ymax=+8.3]
  \tkzFct[ultra thick, color=Maroon!50!black, domain=7.9:10.3] {1.4*x-6}
  \tkzFct[thick, color=Cyan!50!black, domain=7.9:10.3] {1.4*x-6} 
  \fill [Cyan!50] (8.5, 5.9) -- (9.5, 7.3) -- (8.5, 7.3) -- cycle;
  \begin{scope}[color=Black]
    \filldraw  (9.5, 7.3) circle (2pt) node [right] {\(A\)}
               (8.5, 5.9) circle (2pt) node [below, xshift=+1mm] {\(P_n\)};
    \draw (9.2, 7.2) node [above, xshift=-1mm] {dx}
           node [below left, xshift=-1mm] {df(x)};
    \draw [dashed] 
          (5, 4) -- (5, 0)  node [below] {\(x\approx x+dx\)}
          (5, 4) -- (0, 4)  node [left] {\(f(x)\approx f(x+dx)\)}
          (8.5, 5.9) -- (8.5, 4.6)   (9.5, 7.3) -- (9.5, 4.6)
          (8.5, 5.9) -- (7.15, 5.9)  (9.5, 7.3) -- (7.2, 7.3);
    \microscopio{(5, 0)}{3}{20}{230}{2}{(11.5, 3.5)}{\(\times \infty\)}
    \draw (7.1, 2) --(11, 2);
    \draw [dashed] 
          (8.5, 4.5) -- (8.5, 2) node [below] {x}
          (9.5, 4.5) -- (9.5, 2) node [below, xshift=2mm, yshift=+0.7mm]  
                                      {x+dx};
    \microscopio{(0, 4)}{1}{120}{250}{2}{(2.3, 8)}{\(\times \infty\)}
    \draw (1, 4.9) --(1, 8.6);
    \draw [dashed] 
          (2, 6) -- (1, 6) node [left] {\(f(x)\)}
          (2, 7.3) -- (1, 7.3) node [left] {f(x+dx)};
  \end{scope}

    }
}

\newcommand{\derivaradice}{% derivate della radice.
    \disegnod{4.5}{
    \rcom{-1}{+7}{-5}{+2}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+7.3, ymin=-5.3, ymax=+4.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-.3:7.3]{1-2*sqrt(x)}
     \tkzFct[thick, dashed, color=Cyan!20!black, domain=.3:+7.3]{-.5*x-1}
     \filldraw (4, -3) circle (1.2pt);
    }
}

\newcommand{\derivaradiceinzero}{% derivate della radice.
    \disegnod{4.5}{
    \rcom{-1}{+7}{-2}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+7.3, ymin=-5.3, ymax=+4.3]
    \tkzFct[ultra thick, color=Maroon!50!black, domain=-.3:2.3]{1-2*sqrt(x)}
    \microscopio{(0, 1)}{1}{10}{200}{3}{(1, 5)}
    {\(\times \frac{1} {\sqrt{\epsilon}}\)};
    \draw [gray!50, very thin] (4,-.8) -- (4,5.1);
    \draw [black!, ultra thick] (4,2) -- (4, 0);
          % node  {\(1-2\sqrt{\epsilon}\)};
    \filldraw (4, 2) circle (1.5pt) node [right] {\(1\)};
    \microscopio{(3.7, 2)}{3}{30}{200}{3}{(6.5, 7)}{};
%    {\(\times\frac{1} {\sqrt{\epsilon}}\)};
    \draw [gray!50, very thin] (9,1.6) -- (9, 7.6);
%      (6.5, 4.8) --(12.5, 4.8);
     %\draw [black!, ultra thick] (9, 4.8) -- (10, 4.8) 
      %      node [above] {\(dx=\epsilon\)};
     \draw  [color=Green!60!black, ultra thick] (9, 4.8) -- (9,1.6);
    \filldraw [black!] (9, 4.8) circle (1.5pt); % node [left] {\(1\)};
    \draw (3.5, 2) pic [rotate=270, scale=.5] {telescopio=-\(\frac{1}
    {\sqrt{\epsilon}}\)}; %\(1-2\sqrt{\epsilon}\)};
    \draw  [color=Maroon!40!black, dotted, thick] (10, 7.6) -- (10, 1.6);
   }
}

\newcommand{\derivaomografica}{% derivata f omogr.
    \disegnod{4.5}{
    \rcom{-3}{+7}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-3.3, xmax=+7.3, ymin=-5.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-3.3:2.0]{1/(x-2)}
     \tkzFct[ultra thick, color=Maroon!50!black, domain=2.0:7.3]{1/(x-2)}
     \tkzFct[thick, color=Cyan!50!black, domain=-1:+3]{-x}
     \filldraw (1, -1) circle (1.4pt);
    }
}

\newcommand{\derivamodulouno}{% derivate val ass.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-2}{+6}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+6.3, ymin=-4.3, ymax=+4.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=0:4.0]{x}
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-4:0]{-x}
     %\tkzFct[thick, color=Cyan!50!black, domain=:+2]{-x}
    % \filldraw (2, 2) circle (1.4pt);
    }
}

\newcommand{\derivamodulodue}{% derivate val ass.
    \disegnod{4.5}{
    \rcom{-2}{+6}{-4}{+4}{gray!50, very thin, step=1}
    \tkzInit[xmin=-2.3, xmax=+6.3, ymin=-4.3, ymax=+4.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-2.3:2.0]{.5*x+1}
     \tkzFct[ultra thick, color=Maroon!50!black, domain=2.0:6.3]{-.5*x+3}
     %\tkzFct[thick, color=Cyan!50!black, domain=:+2]{-x}
     \filldraw (2, 2) circle (1.4pt);
    }
}

\newcommand{\parabola}{%  y=x^2 e tangenti
    \disegnod{4.5}{
    \rcom{-4}{+4}{-1}{+9}{gray!50, very thin, step=1}
    \tkzInit[xmin=-3.3, xmax=+3.3, ymin=-1.3, ymax=+9.3]
    \tkzFct[ultra thick, color=Green!60!black, domain=-3.3:+3.3]{x*x}
    \begin{scope}[thick, dotted, color=Maroon!40!black]
     \tkzInit[xmin=-4., xmax=+4, xstep=1., ymin=-1,ymax=9.3]
     \tkzFct[domain=-4:+4]{-6*(x+3)+9}
     \tkzFct[domain=-4:+4]{-3*(x+1.5)+2.25}
     \tkzFct[domain=-4:+4]{-1*(x+.5)+.25} 
     \tkzFct[domain=-4:+4]{0}     
     \tkzFct[domain=-4:+4]{6*(x-3)+9}
     \tkzFct[domain=-4:+4]{3*(x-1.5)+2.25}
     \tkzFct[domain=-4:+4]{1*(x-.5)+.25}    
    \end{scope}
   }
}
    

\newcommand{\tangentiparabola}{% 
    % definita in intervallo 0-inf.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-5}{+5}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-5.3, ymax=+5.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:+4.3]{2*x}
    }
}

\newcommand{\cubica}{%  y=x^3 e tangenti
    \disegnod{4.5}{
    \rcom{-4}{+4}{-7}{+7}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-7.3, ymax=+7.3]
    \tkzFct[ultra thick, color=Green!60!black, domain=-4.3:+4.3]{x*x*x}
    \begin{scope}[thick, dotted, color=Maroon!40!black]
     \tkzInit[xmin=-4., xmax=+4, xstep=1., ymin=-6.3,ymax=4]
     \tkzFct[domain=-2:-1.5]{12*(x+2)-8}
     \tkzFct[domain=-2.5:0]{6.75*(x+1.5)-3.375}
     \tkzFct[domain=-4:+4]{3*(x+1)-1} 
     \tkzFct[domain=-4:+2]{.75*(x+.5)-.125}    
     \tkzFct[domain=-4:+4]{0}  
   \tkzInit[xmin=-4., xmax=+4, xstep=1., ymin=-6.3,ymax=6]
     \tkzFct[domain=-2:+4]{.75*(x-.5)+.125}     
     \tkzFct[domain=0.2:+3]{3*(x-1)+1}
     \tkzFct[domain=0.5:2.5]{6.75*(x-1.5)+3.375}
     \tkzFct[domain=2:+4]{18.75*(x-2.5)+15.625}
    \end{scope}
   }
}

\newcommand{\tangenticubica}{% 
    % definita in intervallo 0-inf.
    \disegnod{4.5}{
    \rcom{-4}{+4}{-1}{+13}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-1.3, ymax=+13.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:+4.3]{3*x*x}
    }
}

\newcommand{\radquad}{%  y=sqrt{x} e tangenti
    \disegnod{4.5}{
    \rcom{-1}{+12}{-1}{+4}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+12.3, ymin=-1.3, ymax=+7.3]
    \tkzFct[ultra thick, color=Green!60!black, domain=0:+12.3]{sqrt(x)}
    \begin{scope}[thick, dotted, color=Maroon!40!black]
     \tkzInit[xmin=-1., xmax=+12.3, xstep=1., ymin=-1,ymax=4.3]
     \tkzFct[domain=-1:+6]{x-.25+.5}    
     \tkzFct[domain=-1:+6]{.5*(x-1)+1}
     \tkzFct[domain=-0:+9]{.29*(x-3)+1.73}
     \tkzFct[domain=1:+12.3]{.19*(x-7)+2.65} 
    \end{scope}
   }
}
   
\newcommand{\tangentiradquad}{% 
    % definita in intervallo 0-inf.
     \disegnod{4.5}{
     \rcom{-1}{+12}{-1}{+8}{gray!50, very thin, step=1}
     \tkzInit[xmin=0, xmax=+12.3, ymin=-1.3, ymax=+8.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-.3:+12.3]{1/(2*sqrt(x))}
    }
}

\newcommand{\recip}{%  y=sqrt{x} e tangenti
    \disegnod{4.5}{
    \rcom{-6}{+6}{-6}{+6}{gray!50, very thin, step=1}
    \tkzInit[xmin=-6.3, xmax=+6.3, ymin=-6.3, ymax=+6.3]
    \tkzFct[ultra thick, color=Green!60!black, domain= -6.3:-0.1]{1/x}
    \tkzFct[ultra thick, color=Green!60!black, domain= 0.1:6.3]{1/x}    
    \begin{scope}[thick, dotted, color=Maroon!40!black]
     \tkzInit[xmin=-6.3, xmax=+6.3, xstep=1.0, ymin=-6.3,ymax=6.3]
     \tkzFct[domain=-6.3:+0]{-.04*(x+5)-.2}    
     \tkzFct[domain=-5.3:+0]{-.111*(x+3)-.333}
     \tkzFct[domain=-4:+2]{-x-2}   
     \tkzFct[domain=-1.5:2]{-4*(x+.5)-2}
     \tkzFct[domain=-.5:0]{-25*(x+.2)-5} 
     \tkzFct[domain=0:+6.3]{-.04*(x-5)+.2}    
     \tkzFct[domain=0:5.3]{-.111*(x-3)+.333}
     \tkzFct[domain=-2:+4]{-x+2}   
     \tkzFct[domain=-.5:1.5]{-4*(x-.5)+2}
     \tkzFct[domain=0.1:5]{-25*(x-.2)+5}   
    \end{scope}
   }
}
   
\newcommand{\tangentirecip}{% 
    % definita in intervallo 0-inf.
     \disegnod{4.5}{
      \rcom{-6}{+6}{-10}{+2}{gray!50, very thin, step=1}
      \tkzInit[xmin=-6.3, xmax=+6.3, ymin=-10.3, ymax=0]
      \tkzFct[ultra thick, color=Maroon!50!black, domain=-6.3:-.3]{-1/(x*x)}
      \tkzFct[ultra thick, color=Maroon!50!black, domain=.3:6.3]{-1/(x*x)}
     
    }
}

\newcommand{\boxfcomposta}{% rettangolo 
  \def \xa{2}
  \def \ya{0}
  \def \xb{12}
  \def \yb{8}
  \def \xl{\xa/2+\xb/2}
  \def \lato {3}
  \def \xp {\xa+1}
  \def \yp {\ya+2.5}
  \def \xq {\xa+6}
  \disegno{
    \draw (\xa, \ya) -- (\xb, \ya) -- (\xb, \yb) -- (\xa, \yb) -- cycle
          (\xl, \ya) node [below] {\(v(u(t))\)};
    \draw (\xp, \yp) -- (\xp+\lato, \yp) -- 
          (\xp+\lato, \yp+\lato) -- (\xp, \yp+\lato) --cycle
          (\xp+\lato/2, \yp) node [below] {\(u(t)\)}
          (\xp+\lato/2, \yp+\lato/2) node {\(3\cdot 6-2\)}
          (\xp+\lato/2, \yp+\lato) node [above]{\(3t-2\)};
    \draw (\xq, \yp) -- (\xq+\lato, \yp) -- 
          (\xq+\lato, \yp+\lato) -- (\xq, \yp+\lato) --cycle
          (\xq+\lato/2, \yp) node [below] {\(v(u)\)}
          (\xq+\lato/2, \yp+\lato/2) node {\(\dfrac{16^2}{8}\)}
          (\xq+\lato/2, \yp+\lato) node [above]{\(\dfrac{u^2}{8}\)}; 
%seguono frecce
          \draw  [->] (0,\yb/2) --++ (3,0); 
          \draw (1.5,\yb/2) node [below] {\(6\)};   
          \draw  [->] (6,4) --++ (2,0); 
          \draw (7,4) node [below] {\(16\)};   
          \draw  [->] (11,4) --++ (3,0); 
          \draw (13,4) node [below] {\(32\)};   
    }
}

\newcommand{\diffcomposta}{%differenziale di f composta
   \disegnod{3}{
  \draw[gray!50, very thin, step=1] 
  (-0.3, -10-0.3) grid (10+0.3, 10+0.3); % Griglia
  \begin{scope}[-{Stealth[length=2mm, open, round]}, black] % Assi
    \draw (0, 0) -- (0, -10-0.5) 
      node [left, yshift=-3pt] {\(t\)};
    \draw (-0.3, 0) -- (10+0.5, 0) 
      node [below, xshift=-3pt] {\(u\)};
    \draw (0, 0) -- (0, 10+0.5) 
      node [left, yshift=-3pt] {\(v\)};
  \end{scope}
   \tkzInit[xmin=0, xmax=+8.3, ymin=-9, ymax=10]
   \tkzFct[ultra thick, color=Maroon!50!black, domain=0:7.3]{-.33*x-.66}
   \tkzFct[ultra thick, color=Maroon!50!black, domain=0:8.3]{x*x/8}
   \draw [color=Cyan!50!black](0, -1.5) -- (2.5, -1.5) -- (2.5, .8) -- (0, .8)
      node [black, left, xshift=1mm] {\(v(u)\)};
   \draw [black] (0, -1.5) node [left] {\(t\)}
        (2.4, -0.5) node {\(u(t)\)}
        (7, -3) node {\(u=f(t)\)}
        (8, 8) node  {\(v=f(u)\)};
         
 \begin{scope}[black, font=\fontsize{6}{6}]       
  \microscopio{(0, -1.5)}{2}{220}{0}{3}{(-4, -6)}{\(\times \infty\)} %mic. per dt
  \draw [gray!50, very thin] (-5,-6) -- (-5, 0.2);
  \fill [Cyan!50] (-5, -2.5) -- (-1.6, -2.5) -- (-1.6, -3.5) -- (-5,-3.5);
  \filldraw (-5, -3.5) circle (1.4pt) (-5, -2.5) circle (1.4pt);   
  \draw  (-5, -3) node [left] {\(dt\)};
 \draw  (-3.5, -3.3) node [below] {\(t+dt\)} (-3.5, -2.7) node [above] {\(t\)};
                  
 \microscopio{(2.5, -1.5)}{1}{-90}{90}{3}{(4, -8)}{\(\times \infty\)} %mic. per dt/du
 \draw [ultra thick, color=Maroon!50!black] (-.3, -4.5) -- (5.3, -6.5);
 \fill [Cyan!50] (.8, -5) -- (3.7, -6) -- (-.4, -6) -- (-.4, -5);
 \fill [Cyan!50] (1, -4.9) -- (3.8, -5.9) -- (3.8, -2.8) -- (1, -2.9);
 \draw  (.5, -5.5) node {\(dt\)};
    \filldraw (1, -5) circle (1.4pt) (3.8, -5.9) circle (1.4pt); 
    \draw  (2.5, -4) node  {\(du=3dt\)};

    \microscopio{(2.4, 0)}{1.5}{10}{200}{3}{(8.5, -1.5)}{\(\times \infty\)} %mic. per du
    \fill [Cyan!50] (5.2, -1.3) -- (8.2, -1.3) -- (8.2, 3.8) -- (5.2, 3.8);
    \draw [gray!50, very thin] (3.8, 1) -- (9.7, 1);
    \draw (6.7, .5) node {\(du\)}  (4.8, 1.5) node {\(u\)}
          (9.5, 1.5) node {\(u+du\)};
 
   \microscopio{(2.5, .8)}{3}{90}{-90}{3}{(6, 8.5)}{\(\times \infty\)} %mic. per du/dv
   \tkzFct[ultra thick, color=Maroon!50!black, domain=0.1:5.2]{.6*x+5}
   \fill [Cyan!50] (1, 4.2) -- (4, 4.2) -- (4, 7.3) -- (1, 5.5);
   \fill [Cyan!50] (1, 5.7) -- (4, 7.5) -- (-0.4, 7.5) -- (-0.3, 5.7);
   \draw  (2.5, 5) node {\(du\)} (-.3, 6.5) node {\(dv\approx\frac{u}{4}du\)};
   \filldraw (1, 5.6) circle (1.4pt) (4, 7.4) circle (1.4pt); 

   \microscopio{(0, .8)}{3}{120}{0}{3}{(-4, 7)}{\(\times \infty\)} %mic. per dv
   \draw [gray!50, very thin] (-5,.4) -- (-5, 6.4);
   \fill [Cyan!50] (-5, 2.3) -- (-5, 4.1) -- (-1.7, 4.1) -- (-1.7, 2.3);
   \draw (-4.8, 3.2) node {\(dv=\frac{9t-6}{4}dt\)};
   \filldraw (-5, 2.3) circle (1.4pt) (-5, 4.1) circle (1.4pt); 
   \draw  (-3.5, 2.1) node {\(v\)} (-3.5, 4.3) node {\(v+dv\)};                
  \end{scope}              
   }
}

\newcommand{\diffinversa}{% parabola e radice per x>=0 
    \disegnod{4.5}{
    \rcom{-1}{+10.3}{-1}{+9}{gray!50, very thin, step=1}
    \tkzInit[xmin=-0.3, xmax=+10.3, ymin=-0.3, ymax=+9.3]
    \tkzFct[ultra thick, color=Maroon!50!black, domain=0:+4.3]{x*x/2}
    \tkzFct[ultra thick, color=Green!50!black, domain=0:+10.3]{sqrt(2*x)}
    \tkzFct[thick, black, dashed, domain=0:+10.3]{x}
    \draw [thick, dotted] (8, 4) -- (4, 8);
    \draw [color=Cyan!50!black, thin](8, 0) -- (8, 4) -- (0, 4)
         (4, 0) -- (4, 8) -- (0, 8);
     \draw [black](8, 0) node [below] {\(x\)} (4, 0) node [below] {\(y\)}
           (0, 8) node [left] {\(x=f(y)\)} (0, 4) node [left] {\(y=f^{-1}(x)\)}
           (2.5, 6) node [rotate=75]{\(y=f(x)\)} 
           (5, 2.5) node [rotate=15]{\(y=f^{-1}(x)\)}
           (8, 7) node [rotate=45]{\(y=x\)};
     \begin{scope} [black, thick]      
     \microscopio{(8, 4)}{1}{-60}{150}{2}{(11.5, 4.3)}{\(\times \infty\)} 
     \draw (8.2, 2.5) -- (12, 3);
     \fill [Cyan!50] (8.2, 2.45) -- (11.3, 2.45) -- (11.3, 2.9);
     \draw [font=\fontsize{6}{6}] (10, 2) node {\(dx\)} 
         (11.7, 2.6) node {\(dy\)};
     \microscopio{(4, 8)}{1}{60}{-150}{2}{(8.5, 11.5)}{\(\times \infty\)} 
     \draw (6.1, 7.9) -- (6.6, 11.8);
     \fill [Cyan!50] (6, 7.9) -- (6.5, 11) -- (6, 11);
      \draw [font=\fontsize{6}{6}] (6.2, 11.3) node {\(dx\)} 
          (5.7, 9.5) node {\(dy\)};
     \end{scope}
     }
}

\newcommand{\esp}{%  y=a^x e tangenti
    \disegnod{4.5}{
    \rcom{-1}{+6}{-1}{+11}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+6.3, ymin=-.3, ymax=+11.3]
    \tkzFct[ultra thick, color=Green!60!black, domain=-1.3:+7]{2**x}
    \begin{scope}[thick, dotted, color=Maroon!40!black]
     \tkzInit[xmin=-1.3, xmax=+6.3, xstep=1., ymin=-1,ymax=11]
     \tkzFct[domain=-1.3:4.3]{.5*(x+1)+.4}    
     \tkzFct[domain=-1:+5]{.4}
     \tkzFct[domain=-0.5:5]{2*(x-1)+1.9}
     \tkzFct[domain=0:+5.5]{4*(x-2)+3.6} 
     \tkzFct[domain=1:+6]{8*(x-3)+7.6} 
    \end{scope}
   }
}
   
\newcommand{\tangentiesp}{% 
    % definita in intervallo 0-inf.
     \disegnod{4.5}{
     \rcom{-1}{+6}{-1}{+11}{gray!50, very thin, step=1}
     \tkzInit[xmin=-1.3, xmax=+6.3, ymin=-.3, ymax=+11.3]
      \tkzFct[ultra thick, color=Maroon!50!black, domain=-1.3:+4]{.7*2**x}
     }
}

\newcommand{\esplog}{%  y=e^x e ln x
    \disegnod{4.5}{
    \rcom{-6}{+10}{-6}{+10}{gray!50, very thin, step=1}
    \tkzInit[xmin=-6.3, xmax=+10.3, ymin=-6.3, ymax=+10.3]
    \tkzFct[ultra thick, color=Maroon!60!black, domain=-4.3:+6]{2.72**x}
    \tkzFct[ultra thick, color=Green!60!black, domain=0:+10.3]{log(x)}
    \tkzFct[thick, black, dashed, domain=-4:+10.3]{x}
   }
}

\newcommand{\dseno}{%  y=a^x e tangenti
    \disegnod{4.5}{
    \draw [fill=white] (0,0) --+(6: 0)   
      arc [start angle=0, delta angle=90, radius=6];
     \draw (-6,0) -- (.5, 0)     (-6,0) -- (-6, 6.5)
           (-6,0) -- (-.5, 2);
     \begin{scope} [font=\fontsize{7}{7}]
      \filldraw (-.35, 2) circle (1.2pt) node [right] {\(A\approx B\approx C\)};
      \draw (-.35, 2) -- (-.35, 0) node [below] {\(A'\approx B'\)}
            (-4, .3) node [right, rotate = 13] {\(x\approx x+dx\)}
            (0, 1) node [right] {\(\sen x\approx\sen(x+dx)\)}
            (-6, 0) node [left] {\(O\)};
      \microscopio{(-.35, 2)}{1}{90}{-90}{3}{(-3.4, 8)}{\(\times \infty\)}
      \draw (2, 4.1) -- (.3, 9) (1.5, 5.5) -- (-2.8, 4.2)
            (.8, 7.5) -- (-3.3, 6.4) 
            (.8, 7.5) -- (.8, 3.2) (1.5, 5.5) -- (.75, 5.5)
            (.75, 6.4) node [left]  {\(d\sen x\)}
            (1, 6.3) node [right]  {\(dx\)}
            (1, 6.5) node {\(x\)};
      \filldraw (1.5, 5.5) circle (1.2pt) node [right] {\(A\)}
                 (.8, 7.5) circle (1.2pt) node [right] {\(B\)}
                 (.75, 5.5) circle (1.2pt) node [left] {\(C\)};
     \end{scope}
     }
}   

\newcommand{\seno}{ %
        \disegnod{6}{
    \rcom{-4}{+6}{-2}{+2}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+6.3, ymin=-4, ymax=+4]
    \tkzFct[ultra thick, color=Green!60!black, domain=-4.3:+6.3]{sin(x)}
    \begin{scope}[thick, dashed, color=Maroon!40!black]
     \tkzInit[xmin=-4.3, xmax=+6.3, xstep=1, ymin=-2, ymax=2]
     \foreach \i in {-4, -3.5, -3, -2.5, -2, -1.5, -1, -.5,
         0, .5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6}
     \tkzFct[domain=\i-2:\i+2]{cos(\i)*(x-\i)+sin(\i)};    
    \end{scope}
   }
}
  
\newcommand{\tangentiseno}{% 
    % definita in intervallo 0-inf.
      \disegnod{6}{
      \rcom{-4}{+6}{-2}{+2}{gray!50, very thin, step=1}
     \tkzInit[xmin=-4.3, xmax=+6.3, ymin=-4, ymax=4]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:+6.3]{cos(x)}
      }
}

\newcommand{\coseno}{ %
        \disegnod{6}{
    \rcom{-4}{+6}{-2}{+2}{gray!50, very thin, step=1}
    \tkzInit[xmin=-4.3, xmax=+6.3, ymin=-4, ymax=+4]
    \tkzFct[ultra thick, color=Green!60!black, domain=-4.3:+6.3]{cos(x)}
    \begin{scope}[thick, dashed, color=Maroon!40!black]
     \tkzInit[xmin=-4.3, xmax=+6.3, xstep=1, ymin=-2, ymax=2]
     \foreach \i in {-4, -3.5, -3, -2.5, -2, -1.5, -1, -.5,
         0, .5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6}
     \tkzFct[domain=\i-2:\i+2]{-sin(\i)*(x-\i)+cos(\i)};    
    \end{scope}
   }
}
  
\newcommand{\tangenticoseno}{% 
    % definita in intervallo 0-inf.
      \disegnod{6}{
      \rcom{-4}{+6}{-2}{+2}{gray!50, very thin, step=1}
     \tkzInit[xmin=-4.3, xmax=+6.3, ymin=-4, ymax=4]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=-4.3:+6.3]{-sin(x)}
      }
}


\newcommand{\tangente}{ %
    \disegnod{4.5}{
    \rcom{-3.5}{+3.5}{-6}{+6}{gray!50, very thin, step=1}
    \tkzInit[xmin=-3.8, xmax=+3.8, ymin=-6.3, ymax=+6.3]
    \tkzFct[ultra thick, color=Green!60!black, domain=-3.14:-1.58]{tan(x)}
    \tkzFct[ultra thick, color=Green!60!black, domain=-1.55:1.55]{tan(x)}
    \tkzFct[ultra thick, color=Green!60!black, domain= 1.58: 3.14]{tan(x)}
     \begin{scope}[thick, dashed, color=Maroon!40!black, xstep=1]
      \foreach \i in {-3, -2.5, -2, -1.8}
           \tkzFct[domain=\i-1:\i+1]{(x-\i)/(cos(\i))**2+tan(\i)};
      \foreach \i in {-1.5, -1, -.5, 0, .5, 1, 1.5}
           \tkzFct[domain=\i-1:\i+1]{(x-\i)/(cos(\i))**2+tan(\i)};
      \foreach \i in {1.8, 2.2, 2.7, 3, 3.1}
           \tkzFct[domain=\i-1:\i+1]{(x-\i)/(cos(\i))**2+tan(\i)};
     \end{scope}
   }
}
  
\newcommand{\tangentitangente}{% 
%    definita in intervallo 0-inf.
     \disegnod{4.5}{
     \rcom{-4}{+4}{-1}{+6}{gray!50, very thin, step=1}
     \tkzInit[xmin=-4.3, xmax=+4.3, ymin=-1, ymax=6.3]
      \begin{scope}[ultra thick, color=Maroon!50!black]
     \tkzFct [domain=-3.1:-1.6]{1/(cos(x))**2}
      \tkzFct [domain=-1.54:1.54]{1/(cos(x))**2}
     \tkzFct [domain=1.6:3.1]{1/(cos(x))**2}
     \end{scope}
     }
}

% \newcommand{\derivata}{% 
%     % definita in intervallo 0-inf.
%       \disegnod{6}{
%       \rcom{-1}{+6}{-1}{+6}{gray!50, very thin, step=1}
%      \tkzInit[xmin=-1.3, xmax=+11.3, ymin=-1, ymax=12]
%      \tkzFct[ultra thick, color=Maroon!50!black, domain=.5:5]{3*sin(.5*x)}
%      \draw [color=Cyan!50!black, thick, dashed](.8, 1.9) -- (4, 3.7);
%      \begin{scope}[black]
%        \draw (-.5, 2.85) node [rotate=90] {\(f(x_0)\approx f(x_0+dx)\)}-- 
%        (2.5, 2.85) -- (2.5, 0) node [below] {\(x_0\approx x_0 + dx\)}
%        (5,1.5) node {\(y=f(x)\)} (6, 4.8) node [rotate=30]{\(y=f'(x_0)\Delta x+f(x_0)\)};
%        \microscopio{(2.5, 2.85)}{1}{90}{-70}{2}{(0, 7.5)}{\(\times \infty\)}
%        \draw (0, 5) -- (3.4, 7) 
%              (.85, 5.5)   -- (3, 5.5) 
%              (3, 6.8) -- (3, 4.1)  (.85, 5.5) -- (.85, 4.1)
%              (.85, 4.6) node {\(\pst{x_0}\)};
%        \draw (3, 6.1) node {\(dy\)} (1.9, 5.5) node {\(dx\)};
%        \microscopio{(3, 6.8)}{1}{20}{-140}{2}{(6, 6.2)}{\(\times \infty\)}
%        \tkzFct[ultra thick, color=Maroon!50!black, domain=3.88:7.2]{.59*x+5}
%        \draw (6,8) node [rotate=30] {grafico};
%        \tkzFct[ultra thick, color=Cyan!50!black, dashed, domain=3.5:6.8]{.59*x+6}
%        \draw (5,9.3) node [color=Cyan!50!black, rotate=30] {tangente};
%      \end{scope}
%      }
% }

\newcommand{\derivata}{% definita in intervallo 0-inf.
  \disegno[6]{
    \rcom{-1}{+6}{-1}{+6}{gray!50, very thin, step=1}
    \tkzInit[xmin=-1.3, xmax=+11.3, ymin=-1, ymax=12]
    \tkzFct[ultra thick, color=brown!50!black, domain=.5:5]{3*sin(.5*x)-2}
    \draw (2, 1) node [black]{\(P\)};
    \draw [color=cyan!50!black, thick](.8, -.1) -- (6, 2.85);
    \begin{scope}[black]
      \draw [dashed] (-.6, .85) node [rotate=90] 
        {\footnotesize{\(f(x_0)\approx f(x_0+d x)\)}}
        (-.2, .85) -- (2.5, .85) -- (2.5, -0.2) 
        node [below] {\footnotesize{\(x_0\approx x_0 + d x\)}}
        (6, .5) node {\(y=f(x)\)} (6, 2.4) node [rotate=30] {\(y=t(x)\)};
      \microscopio{(2.5, .85)}{1}{90}{-70}{2}{(4, 3.5)}
        {\footnotesize{\(\times \frac{1}{d x}\)}}
      \draw [ultra thick] (0, 3) -- (3.4, 5);
      \draw (.85, 3.5)   -- (3, 3.5) 
            (3, 4.8) -- (3, 2.1)  (.85, 3.5) -- (.85, 2.1)
            (.85, 2.6) node {\(\pst{x_0}\)};
      \draw (3, 4.1) node {\(d y\)} (1.9, 3.5) node {\(d x\)}
            (.5, 3.6) node {\(P\)};
      \microscopio{(3, 4.8)}{2.5}{50}{-100}{2}{(6, 7)}
        {\footnotesize{\(\times \frac{1}{\epsilon d x}\)}}
      \tkzFct[ultra thick, color=brown!50!black, domain=3.7:6.95]{.59*x+5}
      \draw (6,8) node [rotate=30] {\(y=f(x)\)};
      \tkzFct[ultra thick, color=cyan!50!black, dashed, domain=3.2:6.6]
             {.59*x+6}
      \draw (5,9.3) node [color=cyan!50!black, rotate=30] {\(y=t(x)\)};
      \microscopio{(0.85, 3.5)}{1}{80}{-80}{2}{(-1.5, 7)}
        {\footnotesize{\(\times \frac{1}{\epsilon d x}\)}}
      \tkzFct[ultra thick, color=brown!50!black, domain=-1:2.45]{.59*x+6}
      \draw (1, 6) node [rotate=30] {\(y=f(x)\)};
      \tkzFct[ultra thick, color=cyan!50!black, dashed, domain=-1:2.45]
             {.59*x+6}
      \draw (.7, 7) node [color=cyan!50!black, rotate=30] {\(y=t(x)\)};
    \end{scope}
    \draw [red, ultra thick] (5, 8) -- (5, 9) 
          (5.6, 8.85) node [rotate=30] {\(\epsilon d x\)}; 
  }
}

\newcommand{\falsodifferenziale}{% 
    % definita in intervallo 0-inf.
      \disegnod{6}{
      \rcom{-1}{+6}{-1}{+6}{gray!50, very thin, step=1}
     \tkzInit[xmin=-1.3, xmax=+6.3, ymin=-1.3, ymax=6.3]
     \tkzFct[ultra thick, color=Maroon!50!black, domain=.5:4]{3*sin(.5*x)}
     \tkzFct[ultra thick, color=Cyan!50!black, dashed, domain=.5:4]
     {1*(x-1.57)+ 2.15}
     \filldraw (1.57, 3*sin 45) circle (1.4pt);
     \draw [color=Maroon!50!black, thick] (1.57, 2.13) -- (4.2, 2.13)
        (4, 2.13) -- (4, 2.7) 
        (4, 2.4) node {\(\Delta f(x)\)};
     \draw [color=Cyan!50!black, thick] (4.2 , 2.13) -- (5.5, 2.13)
        (5.5, 2.13) -- (5.5, 4.6) --(4, 4.6)
        (5.5, 3.3) node {\(f'(x)\Delta x\)};
      \draw [black] (1.57, 2.13) -- (1.57, 0) node [below] {\(x_0\)}
             (4, 2.7) -- (4, 0) node [below] {\(x_0 + \Delta x\)};
     }
}
